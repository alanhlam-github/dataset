---
title: "Pet Store Sales Demographics"
output:
  html_document:
    code_folding: hide
    df_print: paged
    toc: yes
    toc_float: yes
    number_sections: no
    pdf_document: default
  word_document:
    toc: yes
---

This is an example showcase of analyzing a nonprofit pet store's e-commerce data.

Source: [Pet Store](https://docs.google.com/spreadsheets/d/14GRvWY7b6-1KhTk2noNYotomc0nZRFXf/edit?usp=sharing&ouid=117939447554917976953&rtpof=true&sd=true)

```{r,echo=F}
inu=readxl::read_xlsx('pet store.xlsx')

sum(is.na(inu))
```

No missing values.

## Customer Retention

```{r}
sum(duplicated(inu$cust_id))/sum(!duplicated(inu$cust_id))*100

```

79.95% customer retention rate.

## Customer Age



```{r}
inu %>% 
  rename(Customer_Age=cust_age) %>% 
  tabyl(Customer_Age) %>% 
  arrange(desc(n))

inu %>% 
  ggplot(aes(x=cust_age))+
  geom_bar(color='darkred')+
  labs(y='Total Count',x='Customer Ages')

```

Mid-20s are the biggest group of customers.

## Customer Location

```{r}
inu %>% 
  rename(Customer_State=cust_state) %>% 
  tabyl(Customer_State) %>%
  arrange(desc(n))

inu %>%
  ggplot(aes(y=cust_state))+
  theme_bw()+
  geom_bar(color='darkblue')+
  labs(y='States',x='Total Count')
```

NY, PA, and NJ are the top three states where most of the customers order from.

## Product Sales

```{r}
inu %>% 
  rename(Product_Category=prod_category) %>% 
  tabyl(Product_Category,prod_animal_type) %>%
  adorn_totals() %>% 
  adorn_percentages('all') %>%
  adorn_pct_formatting(digits = 1,affix_sign = T) %>%
  adorn_ns(position='front') %>% 
  arrange(desc(cat))
```

```{r}
inu %>% 
  ggplot(aes(x=prod_category,fill=prod_animal_type))+
  geom_bar()+
  theme_bw()+
  labs(title='Number of Items Sold',x='Product Category',y='Total Count',fill=' ')+
  theme(plot.title = element_text(hjust=.5))

```

Cat products, especially cat treats, are more in demand than dog products.

```{r,warning=F,message=F}
inu %>% 
  group_by('Product_Title'=prod_title,'Product_Category'=prod_category,'Animal_Type'=prod_animal_type) %>% 
  summarise(Total_Sales=sum(total_sales)) %>% 
  arrange(desc(Total_Sales))

#5/31/2023 - son of a bitch, i finally figured out how to rank by Totals through a Youtube vid that I almost didn't watch. Tried to figure this out since yesterday.

```

Reddy Beddy and Cat Cave are the most popular items sold.

```{r,echo=F}
inu$trans_timestamp2=as.Date(inu$trans_timestamp)

inu$trans_date=ymd(inu$trans_timestamp2)

inu=inu %>% 
select(trans_id:trans_timestamp,trans_date,everything())
```

```{r}
sessionInfo()
```
